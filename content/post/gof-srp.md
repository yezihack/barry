---
title: "设计模式-SOLID五大原则(十)"
date: 2021-01-25T21:03:38+08:00
lastmod: 2021-01-25T21:03:38+08:00
draft: false
tags: ["设计模式", "教程"]
categories: ["设计模式"]
author: "百里"
comment: false
toc: true
reward: true
# 音乐开关，true/false
music: true
# 只支持163的音乐，在生成外链播放器获取ID
music_id: "221895"
# 是否自动播放 1是，0否
music_auto: 1
# weight: 1
# description: ""
---



## 单一职责原则(SRP)

> SRP: Single Responsibility Principle
>
> A class or module should have a single reponsilibility.一个类或者模块只负责完成一个职责(或者功能)

一个类只负责完成一个职责或功能, 也就是说, 不要设计大而全的类, 要设计粒度小, 功能单一的类.

换个角度来讲就是. 一个类包含了两个或两个以上业务不相干的功能, 我们就说它的职责不够单一, 应该将它拆分成多个功能更加单一, 粒度更细的类. 

### 如何判断类是否单一

1.  类中的代码行数,函数或者属性过多.
2. 类依赖的其它类过多, 或者依赖类的其它类过多, 不符合高内聚, 低耦合的设计思想.
3. 私有方法过多
4. 比较难给类起一个合适的名字
5. 类中大量的方法都是集中操作类中的某几个属性.

### 如何设计单一类

> 技巧: 持续重构. 没有一尘不变的设计

单一职责原则通过避免设计大而全的类, 避免将不相关的功能耦合在一起, 来提高类的内聚性. 同时类职责单一, 类依赖和被依赖的其它类也会变少, 减少了代码的耦合性, 以此来实现代码的高内聚, 低耦合.

但是, 如果拆分得过细, 实际上会适得其反, 反倒会降低内聚性, 也会影响代码的可维护性.



## 开闭原则(OCP)

> OCP: Open Closed Priciple
>
> Software entities (modules, classes, functions, etc.) should be open for extension, but closed for modification. 
>
> 软件实体(模块, 类, 方法等) 应该对扩展开放, 对修改关闭

扩展性是代码质量最重要的衡量标准之一. 在23种经典设计模式中, 大部门设计模式都是为了解决代码的扩展性问题而存在的, 主要遵从的设计原则就是**开闭原则**

### 对扩展开放,对修改关闭

添加一个新的功能,应该是通过已用的代码基础上扩展代码(新增模块, 类, 方法, 属性等), 而非修改已有代码(修改模块, 类, 方法, 属性等)的方式来完成. 

1. 开闭原则则并不是说完全杜绝修改, 而是以最小的修改代码的代价来完成新功能的开发
2. 同样的代码改动, 在粗代码粒度下, 可能被认定为"修改"; 在细代码粒度下, 可能又被认定为"扩展"



### 提高代码扩展性的方法

> 底层逻辑: 对扩展开放, 对修改关闭

1. 多态
2. 依赖注入
3. 基于接口而非实现编程
4. 设计模式
   1. 装饰器模式
   2. 模板模式
   3. 职责链模式
   4. 状态模式
   5. 等等

### 如何灵活应用开闭原则

> 唯一不变的只有变化本身

开发一般分为

1. 业务导向系统

   1. 金融系统, 电商系统, 物流系统等.
   2. 分析: 
      1. 识别出尽可能多的扩展点, 对业务有足够的了解.
      2.  能够知道当及未来可能要支持的业务需求.

2. 通用,偏底层的系统

   1. 如框架, 组件, 类库等

   2. 分析

      1. 会被如何使用?

      2. 今后打算添加哪些功能?

      3. 未来会有哪些更多的功能需求?

         

Tip: 扩展性是有代价的, 会牺牲可读性. 我们需要在扩展性与可读性之间做平衡. 

1. 某些场景下,代码的扩展性很重要, 可以适当牺牲一些代码的可读性.
2. 另一些场景下, 代码的可读性更加重要, 可以适当牺牲一些代码的可扩展性.

### 为什么要做开闭原则

对扩展开放是为了应对变化(需求), 对修改关闭是为了保证已用代码的稳定性, 最终是为了让系统更有弹性.

**很多设计原则, 设计思想, 设计模式都是以提高代码的扩展性为最终目的的**


















![big-white](https://img.sgfoot.com/b/20210122112114.png?imageslim)